#!/bin/sh

# macOS does not provide `free` command; we need to rely on other methods.

# Extract available (unused) RAM from the `top` output, e.g.
# ```
# PhysMem: 15G used (1740M wired), 1002M unused.
# ```
# into: `1.1G`
MEM="$(top -l1 -s0 | grep 'PhysMem' | grep -o '[0-9]\+[A-Za-z] unused' | grep -o '[0-9]\+[A-Za-z]' | numfmt --from=auto --to=si)"
# Extract free SWAP from `sysctl` output, e.g.
# ```
# vm.swapusage: total = 2048.00M  used = 744.56M  free = 1303.51M  (encrypted)
# ```
# into: `1.4G`
SWAP="$(sysctl vm.swapusage | grep -o 'free = .\+$' | grep -o '[0-9.]\+[A-Za-z]' | numfmt --from=auto --to=si)"

echo "mem:${MEM} swap:${SWAP}"
